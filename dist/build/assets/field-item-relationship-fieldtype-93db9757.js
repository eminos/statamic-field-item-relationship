const get=(t,e,i)=>{if(!e)return;const r=(Array.isArray(e)?e:e.match(/([^[.\]])+/g)).reduce((u,c)=>u&&u[c],t);return r===void 0?i:r};function normalizeComponent(t,e,i,o,r,u,c,_){var s=typeof t=="function"?t.options:t;e&&(s.render=e,s.staticRenderFns=i,s._compiled=!0),o&&(s.functional=!0),u&&(s._scopeId="data-v-"+u);var a;if(c?(a=function(n){n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!n&&typeof __VUE_SSR_CONTEXT__<"u"&&(n=__VUE_SSR_CONTEXT__),r&&r.call(this,n),n&&n._registeredComponents&&n._registeredComponents.add(c)},s._ssrRegister=a):r&&(a=_?function(){r.call(this,(s.functional?this.parent:this).$root.$options.shadowRoot)}:r),a)if(s.functional){s._injectStyles=a;var h=s.render;s.render=function(d,l){return a.call(l),h(d,l)}}else{var f=s.beforeCreate;s.beforeCreate=f?[].concat(f,a):[a]}return{exports:t,options:s}}const _sfc_main={mixins:[Fieldtype],data(){return{sourceComponent:null}},computed:{sourceValue(){if(this.config.source_type==="sibling_or_ancestor"&&this.sourceComponent)return this.sourceComponent.value;if(this.config.source_type==="global")return this.meta.source_value},errorMessage(){if(this.sourceValueIsObject&&!["key","value"].includes(this.config.save_as))return`The source field "${this.config.source_field}" data is an object. Please set the "Save as" to "Key" or "Value".`;if(this.itemsAreObjects===!1&&this.config.save_as!=="value")return`The source field "${this.config.source_field}" data is a simple array of strings. Please set the "Save as" to "Value".`;if(this.itemsAreObjects&&this.config.save_as==="value")return`The source field "${this.config.source_field}" data is an array of objects. To save the entire object, please set the "Save as" option to "Object" instead of "Value".`;if(this.config.source_type==="sibling_or_ancestor"&&!this.sourceComponent)return`The source field "${this.config.source_field}" could not be found.`;if(this.config.source_type==="global"&&!this.meta.source_value)return this.meta.error_message},sourceValueIsObject(){if(this.sourceValue)return typeof this.sourceValue=="object"&&!Array.isArray(this.sourceValue)},items(){return this.sourceValue&&this.sourceValueIsObject?Object.keys(this.sourceValue).map(t=>({key:t,value:this.sourceValue[t]})):this.sourceValue??[]},itemsAreObjects(){if(this.items)return this.items[0]&&typeof this.items[0]=="object"&&!Array.isArray(this.items[0])},selected(){if(!(this.value===null||this.value===void 0||this.value===""||!this.items||!this.sourceValue)){if(this.config.save_as==="key")return this.sourceValueIsObject?this.items.find(t=>t.key===this.value):this.items[this.value];if(this.config.save_as==="value")return this.items.find(t=>t===this.value);if(this.config.save_as==="index")return this.items[this.value];if(this.config.save_as==="id")return this.items.find(t=>t._id===(this.value._id??this.value.id??this.value)||t.id===(this.value._id??this.value.id??this.value));if(["object","object_key"].includes(this.config.save_as)){const t=this.config.object_key,e=get(this.value,t,this.value);return this.items.find(i=>get(i,t)===e)}}}},methods:{onChange(t){if(!t){this.update(null);return}this.config.save_as==="key"&&(this.sourceValueIsObject?this.update(t.key):this.update(this.items.findIndex(e=>e===t))),this.config.save_as==="value"&&(this.sourceValueIsObject?this.update(t.value):this.update(t)),this.config.save_as==="object"&&this.update(t),this.config.save_as==="id"&&this.update(t._id??t.id),this.config.save_as==="index"&&(this.itemsAreObjects?this.update(this.items.findIndex(e=>{const i=e._id??e.id,o=t._id??t.id;return i===o})):this.update(this.items.findIndex(e=>e===t))),this.config.save_as==="object_key"&&this.update(get(t,this.config.object_key))},getOptionLabel(option){return this.config.option_label_source?this.config.option_label_source.startsWith("`")&&this.config.option_label_source.endsWith("`")?eval(this.config.option_label_source):get(option,this.config.option_label_source,option):option}},mounted(){if(this.config.source_type==="sibling_or_ancestor"){let e=function(o){return o.replace(/[!"#$%&'()*+,\/:;<=>?@[\\\]^`{|}~]/g,"\\$&")};var t=e;const i=document.querySelector(e(`.publish-field__${this.config.source_field}`));i&&i.__vue__&&(i.__vue__.field&&i.__vue__.field.handle===this.config.source_field||i.__vue__.config&&i.__vue__.config.handle===this.config.source_field)&&(this.sourceComponent=i.__vue__)}}};var _sfc_render=function t(){var e=this,i=e._self._c;return i("div",[i("v-select",{attrs:{"append-to-body":"",value:e.selected,searchable:!1,"get-option-label":e.getOptionLabel,options:e.items},on:{input:e.onChange},scopedSlots:e._u([{key:"no-options",fn:function(){return[i("div",{staticClass:"my-2"},[e._v(' Source field "'+e._s(e.config.source_field)+'" has no items. ')])]},proxy:!0},{key:"option",fn:function(o){return[i("div",{domProps:{innerHTML:e._s(e.getOptionLabel(o))}})]}},{key:"selected-option",fn:function(o){return[i("div",{domProps:{innerHTML:e._s(e.getOptionLabel(o))}})]}}])}),e.errorMessage?i("div",{staticClass:"mt-2 text-red-500 text-sm",domProps:{textContent:e._s(e.errorMessage)}}):e._e()],1)},_sfc_staticRenderFns=[],__component__=normalizeComponent(_sfc_main,_sfc_render,_sfc_staticRenderFns,!1,null,null,null,null);const FieldItemRelationshipFieldtype=__component__.exports;Statamic.booting(()=>{Statamic.$components.register("field_item_relationship-fieldtype",FieldItemRelationshipFieldtype)});
